<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>3. 数组 - 杨小哥博客</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">杨小哥博客</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">算法 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../数据结构和算法思维导图.md">数据结构和算法思维导图</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#">leetcode</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">数组</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../leetcode/数组/6.Z字形变换/">6.Z字形变换</a>
</li>
            
<li >
    <a href="../../leetcode/数组/11. 盛最多水的容器/">11. 盛最多水的容器</a>
</li>
            
<li >
    <a href="../../leetcode/数组/26.删除排序数组中的重复项/">26.删除排序数组中的重复项</a>
</li>
            
<li >
    <a href="../../leetcode/数组/27.移除元素/">27.移除元素</a>
</li>
            
<li >
    <a href="../../leetcode/数组/35. 搜索插入位置/">35. 搜索插入位置</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">链表</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../leetcode/链表/19. 删除链表的倒数第N个节点/">19. 删除链表的倒数第N个节点</a>
</li>
            
<li >
    <a href="../../leetcode/链表/21. 合并两个有序链表/">21. 合并两个有序链表</a>
</li>
            
<li >
    <a href="../../leetcode/链表/23. 合并K个排序链表(可以优化)/">23. 合并K个排序链表(可以优化)</a>
</li>
            
<li >
    <a href="../../leetcode/链表/24. 两两交换链表中的节点/">24. 两两交换链表中的节点</a>
</li>
            
<li >
    <a href="../../leetcode/链表/206. 反转链表/">206. 反转链表</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">数据结构和算法</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../复杂度分析-上/">1. 复杂度分析-上</a>
</li>
            
<li >
    <a href="../复杂度分析-下/">2. 复杂度分析-下</a>
</li>
            
<li class="active">
    <a href="./">3. 数组</a>
</li>
            
<li >
    <a href="../链表-上/">4. 链表-上</a>
</li>
            
<li >
    <a href="../链表-下/">5. 链表-下</a>
</li>
            
<li >
    <a href="../栈/">6. 栈</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">点开</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../基本排序算法/">基本排序算法</a>
</li>
            
<li >
    <a href="../分治法和归并排序/">分治法和归并排序</a>
</li>
            
<li >
    <a href="../滑动窗口原理/">滑动窗口原理</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">lua <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../lua/表的构造/">lua 表的构造</a>
</li>
                                    
<li >
    <a href="../../lua/select函数/">lua select 函数</a>
</li>
                                    
<li >
    <a href="../../lua/opp/">lua 面向对象</a>
</li>
                                    
<li >
    <a href="../../lua/pairs和ipairs/">pairs和ipairs</a>
</li>
                                    
<li >
    <a href="../../lua/错误处理 pcall & xpcall/">错误处理 pcall & xpcall</a>
</li>
                                    
<li >
    <a href="../../lua/协程实现生产者消费者/">协程实现生产者消费者</a>
</li>
                                    
<li >
    <a href="../../lua/lua 实现单链表/">lua 单链表</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">skynet <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../skynet/并发编程和并行编程/">1. 并发编程和并行编程</a>
</li>
                                    
<li >
    <a href="../../skynet/skynet 基于 Actor 模式的开源框架/">2. skynet 基于 Actor 模式的开源框架</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">python <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#">python 语法</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../python/python相关介绍/">1. python相关介绍</a>
</li>
            
<li >
    <a href="../../python/python基础语法/">2. python基础语法</a>
</li>
            
<li >
    <a href="../../python/python字符串/">3. 字符串</a>
</li>
            
<li >
    <a href="../../python/python循环/">4. 循环</a>
</li>
            
<li >
    <a href="../../python/python列表/">5. 列表</a>
</li>
            
<li >
    <a href="../../python/python元组/">6. 元组</a>
</li>
            
<li >
    <a href="../../python/python字典/">7. 字典</a>
</li>
            
<li >
    <a href="../../python/python集合/">8. 集合</a>
</li>
            
<li >
    <a href="../../python/python函数/">9. 函数</a>
</li>
            
<li >
    <a href="../../python/python作用域/">10. 作用域</a>
</li>
            
<li >
    <a href="../../python/python高阶函数/">11. 高阶函数</a>
</li>
            
<li >
    <a href="../../python/python递归/">12. 递归</a>
</li>
            
<li >
    <a href="../../python/python装饰器/">13. 装饰器</a>
</li>
            
<li >
    <a href="../../python/python模块/">14. 模块</a>
</li>
            
<li >
    <a href="../../python/python包/">15. 包</a>
</li>
            
<li >
    <a href="../../python/python异常/">16. 异常</a>
</li>
            
<li >
    <a href="../../python/python迭代器和生成器/">17. 迭代器和生成器</a>
</li>
            
<li >
    <a href="../../python/字节串和字节数组/">18. 字节串和字节数组</a>
</li>
            
<li >
    <a href="../../python/文件读写/">19. 文件读写</a>
</li>
            
<li >
    <a href="../../python/字符编码/">20. 字符编码</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">21. 面向对象编程</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../python/面向对象编程/">基本语法</a>
</li>
            
<li >
    <a href="../../python/继承派生/">继承派生</a>
</li>
    </ul>
  </li>
            
<li >
    <a href="../../python/迭代器（高级）/">22. 迭代器（高级）</a>
</li>
            
<li >
    <a href="../../python/补充知识点/">补充知识点</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#">django</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../django/1_django介绍及安装/">1. django介绍及安装</a>
</li>
            
<li >
    <a href="../../django/2_django中的路由/">2. django中的路由</a>
</li>
            
<li >
    <a href="../../django/3_django中的HttpRequest对象/">3. HttpRequest对象</a>
</li>
            
<li >
    <a href="../../django/4_django中的session和cookie/">4. session和cookie</a>
</li>
            
<li >
    <a href="../../django/5_django中的模板/">5. django中的模板</a>
</li>
            
<li >
    <a href="../../django/6_django中的模型/">6. django中的模型</a>
</li>
            
<li >
    <a href="../../django/7_django模型中的关系映射/">7. 模型中的关系映射</a>
</li>
            
<li >
    <a href="../../django/8_django自带的后台管理/">8. 自带的后台管理</a>
</li>
            
<li >
    <a href="../../drf/1.django视图之CBV的基本使用/">9. django视图之CBV的基本使用</a>
</li>
            
<li >
    <a href="../../drf/2.CBV中解决csrf认证的问题/">10. CBV中解决csrf认证的问题</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">工具 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../tools/linux操作系统/">linux操作系统</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">理财 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../skynet/并.md">基金理财</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../复杂度分析-下/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../链表-上/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#_1">数组</a></li>
            <li><a href="#_2">如何实现随机访问？</a></li>
            <li><a href="#_3">低效的“插入”和“删除”</a></li>
            <li><a href="#_6">警惕数组的访问越界问题</a></li>
            <li><a href="#_7">容器能否完全替代数组？</a></li>
            <li><a href="#0">为什么很多编程语言中数组都从0开始编号？</a></li>
            <li><a href="#_8">内容小结</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="_1">数组</h1>
<p><img alt="array" src="../../images/array.jpg" /></p>
<p>提到数组，我想你肯定不陌生，甚至还会自信地说，它很简单啊。</p>
<p>是的，在每一种编程语言中，基本都会有数组这种数据类型。不过，它不仅仅是一种编程语言中的数据类型，还是</p>
<p>一种最基础的数据结构。尽管数组看起来非常基础、简单，但是我估计很多人都并没有理解这个基础数据结构的精</p>
<p>髓。</p>
<p>在大部分编程语言中，数组都是从 0 开始编号的，但你是否下意识地想过，<strong>为什么数组要从 0 开始编号，而不是</strong></p>
<p><strong>从 1 开始呢？</strong> 从 1 开始不是更符合人类的思维习惯吗？</p>
<p>你可以带着这个问题来学习接下来的内容。</p>
<h2 id="_2">如何实现随机访问？</h2>
<p>什么是数组？我估计你心中已经有了答案。不过，我还是想用专业的话来给你做下解释。<strong>数组（Array）是一种</strong></p>
<p><strong>线性表数据结构。它用一组连续的内存空间，来存储一组具有相同类型的数据。</strong></p>
<p>这个定义里有几个关键词，理解了这几个关键词，我想你就能彻底掌握数组的概念了。下面就从我的角度分别给</p>
<p>你“点拨”一下。</p>
<p>第一是<strong>线性表</strong>（Linear List）。顾名思义，线性表就是数据排成像一条线一样的结构。每个线性表上的数据最多只</p>
<p>有前和后两个方向。其实除了数组，链表、队列、栈等也是线性表结构。</p>
<p><img alt="线性表" src="../../images/linetable.jpg" /></p>
<p>而与它相对立的概念是<strong>非线性表</strong>，比如二叉树、堆、图等。之所以叫非线性，是因为，在非线性表中，数据</p>
<p>之间并不是简单的前后关系。</p>
<p><img alt="非线性表" src="../../images/ulinetable.jpg" /></p>
<p>第二个是<strong>连续的内存空间和相同类型的数据</strong>。正是因为这两个限制，它才有了一个堪称“杀手锏”的特性：“随机访</p>
<p>问”。但有利就有弊，这两个限制也让数组的很多操作变得非常低效，比如要想在数组中删除、插入一个数据，为</p>
<p>了保证连续性，就需要做大量的数据搬移工作。</p>
<hr />
<p>说到数据的访问，那你知道数组是如何实现根据下标随机访问数组元素的吗？</p>
<p>我们拿一个长度为 10 的 int 类型的数组 int[] a = new int[10] 来举例。在我画的这个图中，计算机给数组 a[10]，</p>
<p>分配了一块连续内存空间 1000～1039，其中，内存块的首地址为 base_address = 1000。</p>
<p><img alt="随机访问" src="../../images/random.jpg" /></p>
<p>我们知道，计算机会给每个内存单元分配一个地址，计算机通过地址来访问内存中的数据。当计算机需要随机访问</p>
<p>数组中的某个元素时，它会首先通过下面的寻址公式，计算出该元素存储的内存地址：</p>
<pre><code class="c">a[i]_address = base_address + i * data_type_size
</code></pre>

<p>其中 data_type_size 表示数组中每个元素的大小。我们举的这个例子里，数组中存储的是 int 类型数据，所以 </p>
<p>data_type_size 就为 4 个字节。这个公式非常简单，我就不多做解释了。</p>
<hr />
<p><strong>这里我要特别纠正一个“错误”。</strong>我在面试的时候，常常会问数组和链表的区别，很多人都回答说，“链表适合插</p>
<p>入、删除，时间复杂度 O(1)；数组适合查找，查找时间复杂度为 O(1)”。</p>
<p>实际上，这种表述是不准确的。数组是适合查找操作，但是查找的时间复杂度并不为 O(1)。即便是排好序的数</p>
<p>组，你用二分<strong>查找</strong>，时间复杂度也是 O(logn)。所以，正确的表述应该是，数组支持<strong>随机访问</strong>，根据下标随机访问</p>
<p>的时间复杂度为 O(1)。</p>
<h2 id="_3">低效的“插入”和“删除”</h2>
<p>前面概念部分我们提到，数组为了保持内存数据的连续性，会导致插入、删除这两个操作比较低效。现在我们就来</p>
<p>详细说一下，究竟为什么会导致低效？又有哪些改进方法呢？</p>
<h3 id="_4">插入操作</h3>
<p>我们先来看插入操作。</p>
<p>假设数组的长度为 n，现在，如果我们需要将一个数据插入到数组中的第 k 个位置。为了把第 k 个位置腾出来，给</p>
<p>新来的数据，我们需要将第 k～n 这部分的元素都顺序地往后挪一位。那插入操作的时间复杂度是多少呢？你可以</p>
<p>自己先试着分析一下。</p>
<p>如果在数组的末尾插入元素，那就不需要移动数据了，这时的时间复杂度为 O(1)。但如果在数组的开头插入元</p>
<p>素，那所有的数据都需要依次往后移动一位，所以最坏时间复杂度是 O(n)。 因为我们在每个位置插入元素的概率</p>
<p>是一样的，所以平均情况时间复杂度为 (1+2+…n)/n=O(n)。</p>
<hr />
<p>如果数组中的数据是有序的，我们在某个位置插入一个新的元素时，就必须按照刚才的方法搬移 k 之后的数据。</p>
<p>但是，如果数组中存储的数据并没有任何规律，数组只是被当作一个存储数据的集合。在这种情况下，如果要将某</p>
<p>个数组插入到第 k 个位置，为了避免大规模的数据搬移，我们还有一个简单的办法就是，直接将第 k 位的数据搬</p>
<p>移到数组元素的最后，把新的元素直接放入第 k 个位置。</p>
<p>为了更好地理解，我们举一个例子。假设数组 a[10] 中存储了如下 5 个元素：a，b，c，d，e。</p>
<p>我们现在需要将元素 x 插入到第 3 个位置。我们只需要将 c 放入到 a[5]，将 a[2] 赋值为 x 即可。最后，数组中的</p>
<p>元素如下： a，b，x，d，e，c。</p>
<p><img alt="插入操作" src="../../images/insert.jpg" /></p>
<p>利用这种处理技巧，在特定场景下，在第 k 个位置插入一个元素的时间复杂度就会降为 O(1)。这个处理思想在快</p>
<p>排中也会用到，我会在排序那一节具体来讲，这里就说到这儿。</p>
<h3 id="_5">删除操作</h3>
<p>我们再来看删除操作。</p>
<p>跟插入数据类似，如果我们要删除第 k 个位置的数据，为了内存的连续性，也需要搬移数据，不然中间就会出现</p>
<p>空洞，内存就不连续了。</p>
<p>和插入类似，如果删除数组末尾的数据，则最好情况时间复杂度为 O(1)；如果删除开头的数据，则最坏情况时间</p>
<p>复杂度为 O(n)；平均情况时间复杂度也为 O(n)。</p>
<p>实际上，在某些特殊场景下，我们并不一定非得追求数组中数据的连续性。如果我们将多次删除操作集中在一起执</p>
<p>行，删除的效率是不是会提高很多呢？</p>
<p>我们继续来看例子。数组 a[10] 中存储了 8 个元素：a，b，c，d，e，f，g，h。现在，我们要依次删除 a，b，c </p>
<p>三个元素。</p>
<p><img alt="删除操作" src="../../images/delete.jpg" /></p>
<p>为了避免 d，e，f，g，h 这几个数据会被搬移三次，我们可以先记录下已经删除的数据。每次的删除操作并不是</p>
<p>真正地搬移数据，只是记录数据已经被删除。当数组没有更多空间存储数据时，我们再触发执行一次真正的删除操</p>
<p>作，这样就大大减少了删除操作导致的数据搬移。</p>
<p>如果你了解 JVM，你会发现，这不就是 JVM 标记清除垃圾回收算法的核心思想吗？没错，数据结构和算法的魅力</p>
<p>就在于此，<strong>很多时候我们并不是要去死记硬背某个数据结构或者算法，而是要学习它背后的思想和处理技巧，这些</strong></p>
<p><strong>东西才是最有价值的</strong>。如果你细心留意，不管是在软件开发还是架构设计中，总能找到某些算法和数据结构的影</p>
<p>子。</p>
<h2 id="_6">警惕数组的访问越界问题</h2>
<p>了解了数组的几个基本操作后，我们来聊聊数组访问越界的问题。</p>
<p>首先，我请你来分析一下这段 C 语言代码的运行结果：</p>
<pre><code class="c">int main(int argc, char* argv[]){
    int i = 0;
    int arr[3] = {0};
    for(; i&lt;=3; i++){
        arr[i] = 0;
        printf(&quot;hello world\n&quot;);
    }
    return 0;
}
</code></pre>

<p>你发现问题了吗？这段代码的运行结果并非是打印三行“hello word”，而是会无限打印“hello world”，这是为什么</p>
<p>呢？</p>
<p>因为，数组大小为 3，a[0]，a[1]，a[2]，而我们的代码因为书写错误，导致 for 循环的结束条件错写为了 i&lt;=3 而</p>
<p>非 i&lt;3，所以当 i=3 时，数组 a[3] 访问越界。</p>
<p>我们知道，在 C 语言中，只要不是访问受限的内存，所有的内存空间都是可以自由访问的。根据我们前面讲的数</p>
<p>组寻址公式，a[3] 也会被定位到某块不属于数组的内存地址上，而这个地址正好是存储变量 i 的内存地址，那么 </p>
<p>a[3]=0 就相当于 i=0，所以就会导致代码无限循环。</p>
<hr />
<p>数组越界在 C 语言中是一种未决行为，并没有规定数组访问越界时编译器应该如何处理。因为，访问数组的本质</p>
<p>就是访问一段连续内存，只要数组通过偏移计算得到的内存地址是可用的，那么程序就可能不会报任何错误。</p>
<p>这种情况下，一般都会出现莫名其妙的逻辑错误，就像我们刚刚举的那个例子，debug 的难度非常的大。而且，</p>
<p>很多计算机病毒也正是利用到了代码中的数组越界可以访问非法地址的漏洞，来攻击系统，所以写代码的时候一定</p>
<p>要警惕数组越界。</p>
<p>但并非所有的语言都像 C 一样，把数组越界检查的工作丢给程序员来做，像 Java 本身就会做越界检查，比如下面</p>
<p>这几行 Java 代码，就会抛出 java.lang.ArrayIndexOutOfBoundsException。</p>
<pre><code class="c">int[] a = new int[3];
a[3] = 10;
</code></pre>

<h2 id="_7">容器能否完全替代数组？</h2>
<p>针对数组类型，很多语言都提供了容器类，比如 Java 中的 ArrayList、C++ STL 中的 vector。在项目开发中，什么</p>
<p>时候适合用数组，什么时候适合用容器呢？</p>
<p>这里我拿 Java 语言来举例。如果你是 Java 工程师，几乎天天都在用 ArrayList，对它应该非常熟悉。那它与数组</p>
<p>相比，到底有哪些优势呢？</p>
<p>我个人觉得，ArrayList 最大的优势就是<strong>可以将很多数组操作的细节封装起来</strong>。比如前面提到的数组插入、删除数</p>
<p>据时需要搬移其他数据等。另外，它还有一个优势，就是<strong>支持动态扩容</strong>。</p>
<p>数组本身在定义的时候需要预先指定大小，因为需要分配连续的内存空间。如果我们申请了大小为 10 的数组，当</p>
<p>第 11 个数据需要存储到数组中时，我们就需要重新分配一块更大的空间，将原来的数据复制过去，然后再将新的</p>
<p>数据插入。</p>
<p>如果使用 ArrayList，我们就完全不需要关心底层的扩容逻辑，ArrayList 已经帮我们实现好了。每次存储空间不够</p>
<p>的时候，它都会将空间自动扩容为 1.5 倍大小。</p>
<p>不过，这里需要注意一点，因为扩容操作涉及内存申请和数据搬移，是比较耗时的。所以，如果事先能确定需要存</p>
<p>储的数据大小，<strong>最好在创建 ArrayList 的时候事先指定数据大小</strong>。</p>
<p>比如我们要从数据库中取出 10000 条数据放入 ArrayList。我们看下面这几行代码，你会发现，相比之下，事先指</p>
<p>定数据大小可以省掉很多次内存申请和数据搬移操作。</p>
<pre><code class="java">ArrayList&lt;User&gt; users = new ArrayList(10000);
for (int i = 0; i &lt; 10000; ++i) {
  users.add(xxx);
}
</code></pre>

<p>作为高级语言编程者，是不是数组就无用武之地了呢？当然不是，有些时候，用数组会更合适些，我总结了几点自</p>
<p>己的经验。</p>
<ol>
<li>Java ArrayList 无法存储基本类型，比如 int、long，需要封装为 Integer、Long 类，而 Autoboxing、Unboxing 则有一定的性能消耗，所以如果特别关注性能，或者希望使用基本类型，就可以选用数组。</li>
<li>如果数据大小事先已知，并且对数据的操作非常简单，用不到 ArrayList 提供的大部分方法，也可以直接使用数组。</li>
<li>还有一个是我个人的喜好，当要表示多维数组时，用数组往往会更加直观。比如 Object[][] array；而用容器的话则需要这样定义：ArrayList &gt; array。</li>
</ol>
<p>我总结一下，对于业务开发，直接使用容器就足够了，省时省力。毕竟损耗一丢丢性能，完全不会影响到系统整体</p>
<p>的性能。但如果你是做一些非常底层的开发，比如开发网络框架，性能的优化需要做到极致，这个时候数组就会优</p>
<p>于容器，成为首选。</p>
<h2 id="0">为什么很多编程语言中数组都从0开始编号？</h2>
<p>现在我们来思考开篇的问题：为什么大多数编程语言中，数组要从 0 开始编号，而不是从 1 开始呢？</p>
<p>从数组存储的内存模型上来看，“下标”最确切的定义应该是“偏移（offset）”。前面也讲到，如果用 a 来表示数组</p>
<p>的首地址，a[0] 就是偏移为 0 的位置，也就是首地址，a[k] 就表示偏移 k 个 type_size 的位置，所以计算 a[k] 的</p>
<p>内存地址只需要用这个公式：</p>
<pre><code class="c">a[k]_address = base_address + k * type_size
</code></pre>

<p>但是，如果数组从 1 开始计数，那我们计算数组元素 a[k] 的内存地址就会变为：</p>
<pre><code class="c">a[k]_address = base_address + (k-1)*type_size
</code></pre>

<p>对比两个公式，我们不难发现，从 1 开始编号，每次随机访问数组元素都多了一次减法运算，对于 CPU 来说，就</p>
<p>是多了一次减法指令。</p>
<p>数组作为非常基础的数据结构，通过下标随机访问数组元素又是其非常基础的编程操作，效率的优化就要尽可能做</p>
<p>到极致。所以为了减少一次减法操作，数组选择了从 0 开始编号，而不是从 1 开始。</p>
<p>不过我认为，上面解释得再多其实都算不上压倒性的证明，说数组起始编号非 0 开始不可。所以我觉得最主要的</p>
<p>原因可能是历史原因。</p>
<p>C 语言设计者用 0 开始计数数组下标，之后的 Java、JavaScript 等高级语言都效仿了 C 语言，或者说，为了在一</p>
<p>定程度上减少 C 语言程序员学习 Java 的学习成本，因此继续沿用了从 0 开始计数的习惯。实际上，很多语言中数</p>
<p>组也并不是从 0 开始计数的，比如 Matlab。甚至还有一些语言支持负数下标，比如 Python。</p>
<h2 id="_8">内容小结</h2>
<p>我们今天学习了数组。它可以说是最基础、最简单的数据结构了。数组用一块连续的内存空间，来存储相同类型的</p>
<p>一组数据，最大的特点就是支持随机访问，但插入、删除操作也因此变得比较低效，平均情况时间复杂度为 </p>
<p>O(n)。在平时的业务开发中，我们可以直接使用编程语言提供的容器类，但是，如果是特别底层的开发，直接使用</p>
<p>数组可能会更合适。</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
